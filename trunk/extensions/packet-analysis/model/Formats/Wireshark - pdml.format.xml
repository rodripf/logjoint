<format>
  <xml max-message-size="768">
    <sample-log><![CDATA[<packet>
  <proto name="geninfo" pos="0" showname="General information" size="54">
    <field name="num" pos="0" show="1" showname="Number" value="1" size="54"/>
    <field name="len" pos="0" show="54" showname="Frame Length" value="36" size="54"/>
    <field name="caplen" pos="0" show="54" showname="Captured Length" value="36" size="54"/>
    <field name="timestamp" pos="0" show="Mar 26, 2019 12:32:05.124621000 CET" showname="Captured Time" value="1553599925.124621000" size="54"/>
  </proto>
  <proto name="frame" showname="Frame 1: 54 bytes on wire (432 bits), 54 bytes captured (432 bits)" size="54" pos="0">
    <field name="frame.encap_type" showname="Encapsulation type: Ethernet (1)" size="0" pos="0" show="1"/>
    <field name="frame.time" showname="Arrival Time: Mar 26, 2019 12:32:05.124621000 CET" size="0" pos="0" show="Mar 26, 2019 12:32:05.124621000 CET"/>
    <field name="frame.offset_shift" showname="Time shift for this packet: 0.000000000 seconds" size="0" pos="0" show="0.000000000"/>
    <field name="frame.time_epoch" showname="Epoch Time: 1553599925.124621000 seconds" size="0" pos="0" show="1553599925.124621000"/>
    <field name="frame.time_delta" showname="Time delta from previous captured frame: 0.000000000 seconds" size="0" pos="0" show="0.000000000"/>
    <field name="frame.time_delta_displayed" showname="Time delta from previous displayed frame: 0.000000000 seconds" size="0" pos="0" show="0.000000000"/>
    <field name="frame.time_relative" showname="Time since reference or first frame: 0.000000000 seconds" size="0" pos="0" show="0.000000000"/>
    <field name="frame.number" showname="Frame Number: 1" size="0" pos="0" show="1"/>
    <field name="frame.len" showname="Frame Length: 54 bytes (432 bits)" size="0" pos="0" show="54"/>
    <field name="frame.cap_len" showname="Capture Length: 54 bytes (432 bits)" size="0" pos="0" show="54"/>
    <field name="frame.marked" showname="Frame is marked: False" size="0" pos="0" show="0"/>
    <field name="frame.ignored" showname="Frame is ignored: False" size="0" pos="0" show="0"/>
    <field name="frame.protocols" showname="Protocols in frame: eth:ethertype:ip:igmp:igmp" size="0" pos="0" show="eth:ethertype:ip:igmp:igmp"/>
  </proto>
  <proto name="eth" showname="Ethernet II, Src: 42:01:c0:a8:00:07 (42:01:c0:a8:00:07), Dst: IPv4mcast_16 (01:00:5e:00:00:16)" size="14" pos="0">
    <field name="eth.dst" showname="Destination: IPv4mcast_16 (01:00:5e:00:00:16)" size="6" pos="0" show="01:00:5e:00:00:16" value="01005e000016">
      <field name="eth.dst_resolved" showname="Destination (resolved): IPv4mcast_16" hide="yes" size="6" pos="0" show="IPv4mcast_16" value="01005e000016"/>
      <field name="eth.addr" showname="Address: IPv4mcast_16 (01:00:5e:00:00:16)" size="6" pos="0" show="01:00:5e:00:00:16" value="01005e000016"/>
      <field name="eth.addr_resolved" showname="Address (resolved): IPv4mcast_16" hide="yes" size="6" pos="0" show="IPv4mcast_16" value="01005e000016"/>
      <field name="eth.lg" showname=".... ..0. .... .... .... .... = LG bit: Globally unique address (factory default)" size="3" pos="0" show="0" value="0" unmaskedvalue="01005e"/>
      <field name="eth.ig" showname=".... ...1 .... .... .... .... = IG bit: Group address (multicast/broadcast)" size="3" pos="0" show="1" value="1" unmaskedvalue="01005e"/>
    </field>
    <field name="eth.src" showname="Source: 42:01:c0:a8:00:07 (42:01:c0:a8:00:07)" size="6" pos="6" show="42:01:c0:a8:00:07" value="4201c0a80007">
      <field name="eth.src_resolved" showname="Source (resolved): 42:01:c0:a8:00:07" hide="yes" size="6" pos="6" show="42:01:c0:a8:00:07" value="4201c0a80007"/>
      <field name="eth.addr" showname="Address: 42:01:c0:a8:00:07 (42:01:c0:a8:00:07)" size="6" pos="6" show="42:01:c0:a8:00:07" value="4201c0a80007"/>
      <field name="eth.addr_resolved" showname="Address (resolved): 42:01:c0:a8:00:07" hide="yes" size="6" pos="6" show="42:01:c0:a8:00:07" value="4201c0a80007"/>
      <field name="eth.lg" showname=".... ..1. .... .... .... .... = LG bit: Locally administered address (this is NOT the factory default)" size="3" pos="6" show="1" value="1" unmaskedvalue="4201c0"/>
      <field name="eth.ig" showname=".... ...0 .... .... .... .... = IG bit: Individual address (unicast)" size="3" pos="6" show="0" value="0" unmaskedvalue="4201c0"/>
    </field>
    <field name="eth.type" showname="Type: IPv4 (0x0800)" size="2" pos="12" show="0x00000800" value="0800"/>
  </proto>
  <proto name="ip" showname="Internet Protocol Version 4, Src: 192.168.0.7, Dst: 224.0.0.22" size="24" pos="14">
    <field name="ip.version" showname="0100 .... = Version: 4" size="1" pos="14" show="4" value="4" unmaskedvalue="46"/>
    <field name="ip.hdr_len" showname=".... 0110 = Header Length: 24 bytes (6)" size="1" pos="14" show="24" value="46"/>
    <field name="ip.dsfield" showname="Differentiated Services Field: 0xc0 (DSCP: CS6, ECN: Not-ECT)" size="1" pos="15" show="0x000000c0" value="c0">
      <field name="ip.dsfield.dscp" showname="1100 00.. = Differentiated Services Codepoint: Class Selector 6 (48)" size="1" pos="15" show="48" value="30" unmaskedvalue="c0"/>
      <field name="ip.dsfield.ecn" showname=".... ..00 = Explicit Congestion Notification: Not ECN-Capable Transport (0)" size="1" pos="15" show="0" value="0" unmaskedvalue="c0"/>
    </field>
    <field name="ip.len" showname="Total Length: 40" size="2" pos="16" show="40" value="0028"/>
    <field name="ip.id" showname="Identification: 0x0000 (0)" size="2" pos="18" show="0x00000000" value="0000"/>
    <field name="ip.flags" showname="Flags: 0x02 (Don&#x27;t Fragment)" size="1" pos="20" show="0x00000002" value="40">
      <field name="ip.flags.rb" showname="0... .... = Reserved bit: Not set" size="1" pos="20" show="0" value="40"/>
      <field name="ip.flags.df" showname=".1.. .... = Don&#x27;t fragment: Set" size="1" pos="20" show="1" value="40"/>
      <field name="ip.flags.mf" showname="..0. .... = More fragments: Not set" size="1" pos="20" show="0" value="40"/>
    </field>
    <field name="ip.frag_offset" showname="Fragment offset: 0" size="2" pos="20" show="0" value="4000"/>
    <field name="ip.ttl" showname="Time to live: 1" size="1" pos="22" show="1" value="01"/>
    <field name="ip.proto" showname="Protocol: IGMP (2)" size="1" pos="23" show="2" value="02"/>
    <field name="ip.checksum" showname="Header checksum: 0x434a [validation disabled]" size="2" pos="24" show="0x0000434a" value="434a"/>
    <field name="ip.checksum.status" showname="Header checksum status: Unverified" size="0" pos="24" show="2"/>
    <field name="ip.src" showname="Source: 192.168.0.7" size="4" pos="26" show="192.168.0.7" value="c0a80007"/>
    <field name="ip.addr" showname="Source or Destination Address: 192.168.0.7" hide="yes" size="4" pos="26" show="192.168.0.7" value="c0a80007"/>
    <field name="ip.src_host" showname="Source Host: 192.168.0.7" hide="yes" size="4" pos="26" show="192.168.0.7" value="c0a80007"/>
    <field name="ip.host" showname="Source or Destination Host: 192.168.0.7" hide="yes" size="4" pos="26" show="192.168.0.7" value="c0a80007"/>
    <field name="ip.dst" showname="Destination: 224.0.0.22" size="4" pos="30" show="224.0.0.22" value="e0000016"/>
    <field name="ip.addr" showname="Source or Destination Address: 224.0.0.22" hide="yes" size="4" pos="30" show="224.0.0.22" value="e0000016"/>
    <field name="ip.dst_host" showname="Destination Host: 224.0.0.22" hide="yes" size="4" pos="30" show="224.0.0.22" value="e0000016"/>
    <field name="ip.host" showname="Source or Destination Host: 224.0.0.22" hide="yes" size="4" pos="30" show="224.0.0.22" value="e0000016"/>
    <field name="" show="Source GeoIP: Unknown" size="4" pos="26" value="c0a80007"/>
    <field name="" show="Destination GeoIP: Unknown" size="4" pos="30" value="e0000016"/>
    <field name="" show="Options: (4 bytes), Router Alert" size="4" pos="34" value="94040000">
      <field name="ip.options.routeralert" showname="IP Option - Router Alert (4 bytes): Router shall examine packet (0)" size="4" pos="34" show="94:04:00:00" value="94040000">
        <field name="ip.opt.type" showname="Type: 148" size="1" pos="34" show="148" value="94">
          <field name="ip.opt.type.copy" showname="1... .... = Copy on fragmentation: Yes" size="1" pos="34" show="1" value="1" unmaskedvalue="94"/>
          <field name="ip.opt.type.class" showname=".00. .... = Class: Control (0)" size="1" pos="34" show="0" value="0" unmaskedvalue="94"/>
          <field name="ip.opt.type.number" showname="...1 0100 = Number: Router Alert (20)" size="1" pos="34" show="20" value="14" unmaskedvalue="94"/>
        </field>
        <field name="ip.opt.len" showname="Length: 4" size="1" pos="35" show="4" value="04"/>
        <field name="ip.opt.ra" showname="Router Alert: Router shall examine packet (0)" size="2" pos="36" show="0" value="0000"/>
      </field>
    </field>
  </proto>
  <proto name="igmp" showname="Internet Group Management Protocol" size="16" pos="38">
    <field name="igmp.version" showname="IGMP Version: 3" size="0" pos="38" show="3"/>
    <field name="igmp.type" showname="Type: Membership Report (0x22)" size="1" pos="38" show="0x00000022" value="22"/>
    <field name="igmp.reserved" showname="Reserved: 00" size="1" pos="39" show="00" value="00"/>
    <field name="igmp.checksum" showname="Checksum: 0xfa02 [correct]" size="2" pos="40" show="0x0000fa02" value="fa02"/>
    <field name="igmp.checksum.status" showname="Checksum Status: Good" size="0" pos="40" show="1"/>
    <field name="igmp.reserved" showname="Reserved: 0000" size="2" pos="42" show="00:00" value="0000"/>
    <field name="igmp.num_grp_recs" showname="Num Group Records: 1" size="2" pos="44" show="1" value="0001"/>
    <field name="" show="Group Record : 224.0.0.251  Change To Include Mode" size="8" pos="46" value="03000000e00000fb">
      <field name="igmp.record_type" showname="Record Type: Change To Include Mode (3)" size="1" pos="46" show="3" value="03"/>
      <field name="igmp.aux_data_len" showname="Aux Data Len: 0" size="1" pos="47" show="0" value="00"/>
      <field name="igmp.num_src" showname="Num Src: 0" size="2" pos="48" show="0" value="0000"/>
      <field name="igmp.maddr" showname="Multicast Address: 224.0.0.251" size="4" pos="50" show="224.0.0.251" value="e00000fb"/>
    </field>
  </proto>
</packet>

]]></sample-log>
    <bounds>
       <end>
         <trie-search>
            <text><![CDATA[</pdml>]]></text>
         </trie-search>
       </end>
    </bounds>
    <head-re><![CDATA[^\<packet\>]]></head-re>
    <xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:lj="http://logjoint.codeplex.com/">
      <xsl:output method="xml" />
      <xsl:template match="packet">
        <m>
          <xsl:attribute name="d">
            <xsl:value-of select="lj:EPOCH_TIME_TO_NATIVE_DATETIME_STR(number(proto[@name='geninfo']/field[@name='timestamp']/@value) * 1000)" />
          </xsl:attribute>
          <xsl:attribute name="s">
            <xsl:choose>
              <xsl:when test="@severity='error'">e</xsl:when>
              <xsl:when test="@severity='warning'">w</xsl:when>
              <xsl:otherwise>i</xsl:otherwise>
            </xsl:choose>
          </xsl:attribute>
          <xsl:for-each select="proto[@name!='geninfo' and @showname]">
            <xsl:value-of select="@showname" />
            <xsl:value-of select="lj:NEW_LINE()" />
            <xsl:apply-templates select="field">
              <xsl:with-param name="pad" select="'    '" />
            </xsl:apply-templates>
          </xsl:for-each>
        </m>
      </xsl:template>
      <xsl:template match="field[@showname or @show][not(@hide) or @hide != 'yes']">
        <xsl:param name="pad" />
        <xsl:value-of select="$pad" />
        <xsl:choose>
          <xsl:when test="@showname">
            <xsl:value-of select="@showname" />
          </xsl:when>
          <xsl:otherwise>
            <xsl:value-of select="@show" />
          </xsl:otherwise>
        </xsl:choose>
        <xsl:value-of select="lj:NEW_LINE()" />
        <xsl:apply-templates select="field">
          <xsl:with-param name="pad" select="concat ($pad, '    ')" />
        </xsl:apply-templates>
      </xsl:template>
    </xsl:stylesheet>
    <patterns />
    <encoding>ACP</encoding>
    <ui-key>wireshark</ui-key>
  </xml>
  <id company="Wireshark" name="pdml" />
  <description>Packet Details Markup Language xml file. tshark outputs it with -T pdml argument.</description>
</format>